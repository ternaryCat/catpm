<h2><%= title %> (<%= samples.size %>)</h2>
<% if samples.any? %>
  <div class="table-scroll">
  <table>
    <thead>
      <tr>
        <th>Duration</th>
        <th>Segments</th>
        <th>Time</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% samples.each do |s| %>
        <% ctx = s.parsed_context; summary = ctx["segment_summary"] || ctx[:segment_summary] || {} %>
        <tr class="linked">
          <td><a href="<%= catpm.sample_path(s) %>" class="row-link mono"><%= format_duration(s.duration) %></a></td>
          <td>
            <% sc = (summary["sql_count"] || summary[:sql_count] || 0).to_i %>
            <% vc = (summary["view_count"] || summary[:view_count] || 0).to_i %>
            <% if sc > 0 || vc > 0 %>
              <span class="mono text-muted"><%= sc %> sql, <%= vc %> views</span>
            <% else %>
              <span class="text-muted">â€”</span>
            <% end %>
          </td>
          <td><%= time_with_tooltip(s.recorded_at) %></td>
          <td style="position:relative; z-index:2; width:28px; padding:4px 2px; text-align:center">
            <button class="action-menu-btn">&#x22EE;</button>
            <div class="action-menu">
              <button class="menu-danger" data-action="delete" data-url="<%= catpm.sample_path(s) %>">Delete</button>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  </div>
<% else %>
  <div class="empty-state">
    <div class="empty-hint"><%= empty_msg %></div>
  </div>
<% end %>
